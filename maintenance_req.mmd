sequenceDiagram
    autonumber

    actor Resident_Actor
    participant Dorm
    participant Resident
    participant Operating_Staff
    participant Technician
    %% REMOVED: participant Maintenance_Ticket (This was causing the error)

    Resident_Actor ->> +Dorm: request_maintenance(resident_id, room_id, issue_category)
    activate Resident_Actor
    Dorm ->> Dorm: search_resident_by_id(resident_id)
    
    loop resident in dorm.residents
        Dorm ->> +Resident: get_resident_id()
        Resident -->> -Dorm: return id

        alt id == resident_id
            Resident -->> Dorm: return resident_instance
        else id != resident_id
            Resident -->> Dorm: continue loop
        end
    end

    opt resident not found
        Dorm -->> Resident_Actor: return not found
    end

    Dorm ->> Dorm: search_available_staff()
    
    loop os in Dorm.ops
        Dorm ->> +Operating_Staff: get_staff_status()
        Operating_Staff -->> -Dorm: return status

        alt status == "ACTIVE"
            Operating_Staff -->> Dorm: return os_instance
        else status != "ACTIVE"
            Operating_Staff -->> Dorm: continue loop
        end
    end

    opt no available staff
        Dorm -->> Resident_Actor: return no available staff
    end

    Dorm ->> Dorm: get_technician_list()
    Dorm->> Operating_Staff: request_maintenance(reporter, staff, techni_list, room_id, issue_category)
    activate Operating_Staff
    
    %% This command dynamically creates the lifeline
    create participant Maintenance_Ticket
    Operating_Staff->>Maintenance_Ticket: create_mt(reporter, room, issue_category, report_time)
    
    activate Maintenance_Ticket
    Maintenance_Ticket -->> Operating_Staff: return ticket
    deactivate Maintenance_Ticket
    
    Operating_Staff ->> Operating_Staff: find_available_technician(techni_list)
    
    loop tc in techni_list
        Operating_Staff ->> +Technician: get_technician_status()
        Technician -->> -Operating_Staff: return technician_status

        alt status == "ACTIVE"
            Technician -->> Operating_Staff: return tc
        else
            Technician -->> Operating_Staff: continue loop
        end
    end

    opt no available techni
        Operating_Staff -->> Dorm: return not found
        Dorm -->> Resident_Actor: return no available technician
    end

    Operating_Staff ->> Technician: assign_technician(technician, ticket)
    activate Technician
    Technician ->> Maintenance_Ticket: start_maintenance(ticket)
    activate Maintenance_Ticket
    Maintenance_Ticket -->> Technician: return maintenance started
    deactivate Maintenance_Ticket
    
    Technician ->> Maintenance_Ticket: update_maintenance_status(ticket, status)
    activate Maintenance_Ticket
    Maintenance_Ticket -->> Technician: return done
    deactivate Maintenance_Ticket
    
    Technician -->> Operating_Staff: return done
    deactivate Technician
    
    Operating_Staff ->> Operating_Staff: approve_maintenance(ticket)
    activate Operating_Staff
    deactivate Operating_Staff
    
    Operating_Staff -->> Dorm: return done
    deactivate Operating_Staff
    
    Dorm -->> Resident_Actor: return done
    deactivate Resident_Actor
    deactivate Dorm